option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: my_gaff_list.wsgi:application
    
  aws:elasticbeanstalk:environment:proxy:staticfiles:
    /static: static
    /media: media
    
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: my_gaff_list.settings
    PYTHONPATH: "/var/app/current:$PYTHONPATH"
    
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: apache
    
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /api/health/
    MatcherHTTPCode: 200
    
  aws:elbv2:listener:80:
    Protocol: HTTP
    Rules:
      ws:
        PathPatterns: /ws/*
        Process: websocket
        
container_commands:
  01_migrate:
    command: "source /var/app/venv/*/bin/activate && python manage.py migrate --noinput"
    leader_only: true
    
  02_collectstatic:
    command: "source /var/app/venv/*/bin/activate && python manage.py collectstatic --noinput"
    
  03_createsu:
    command: "source /var/app/venv/*/bin/activate && python manage.py create_superuser_if_not_exists"
    leader_only: true
    
  04_load_locations:
    command: "source /var/app/venv/*/bin/activate && python manage.py load_irish_locations || true"
    leader_only: true